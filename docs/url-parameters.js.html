<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>url-parameters.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="UplCookie.html">UplCookie</a><ul class='methods'><li data-type='method'><a href="UplCookie.html#.fromJSON">fromJSON</a></li><li data-type='method'><a href="UplCookie.html#.getCookieName">getCookieName</a></li><li data-type='method'><a href="UplCookie.html#getLocation">getLocation</a></li><li data-type='method'><a href="UplCookie.html#getTouchId">getTouchId</a></li><li data-type='method'><a href="UplCookie.html#save">save</a></li><li data-type='method'><a href="UplCookie.html#setLocation">setLocation</a></li><li data-type='method'><a href="UplCookie.html#setParameters">setParameters</a></li><li data-type='method'><a href="UplCookie.html#toJSON">toJSON</a></li></ul></li></ul><h3>Modules</h3><ul><li><a href="module-DataInfrastructureService.html">DataInfrastructureService</a><ul class='methods'><li data-type='method'><a href="module-DataInfrastructureService.html#.putRecord">putRecord</a></li></ul></li></ul><h3>Global</h3><ul><li><a href="global.html#assignUserToTrackingId">assignUserToTrackingId</a></li><li><a href="global.html#capitalize">capitalize</a></li><li><a href="global.html#getCookie">getCookie</a></li><li><a href="global.html#getInferedMedium">getInferedMedium</a></li><li><a href="global.html#getInferedSource">getInferedSource</a></li><li><a href="global.html#getReferrer">getReferrer</a></li><li><a href="global.html#getUrlParameters">getUrlParameters</a></li><li><a href="global.html#hasReferrer">hasReferrer</a></li><li><a href="global.html#i18nToUplLocale">i18nToUplLocale</a></li><li><a href="global.html#isCustomReferrer">isCustomReferrer</a></li><li><a href="global.html#isPageReload">isPageReload</a></li><li><a href="global.html#isUniplacesReferrer">isUniplacesReferrer</a></li><li><a href="global.html#trackAction">trackAction</a></li><li><a href="global.html#trackTouch">trackTouch</a></li></ul>
</nav>

<div id="main">
    
    <h1 class="page-title">url-parameters.js</h1>
    

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { isUniplacesReferrer, hasReferrer, getReferrer } from './referrer';

export const UrlParameters = [
  { name: 'source', inferedValue: getInferedSource, defaultValue: 'direct' },
  { name: 'medium', inferedValue: getInferedMedium, defaultValue: 'destination_origin_language' },
  { name: 'campaign', inferedValue: () => null, defaultValue: 'city_type' },
  { name: 'term', inferedValue: () => null, defaultValue: null },
  { name: 'content', inferedValue: () => null, defaultValue: null },
  { name: 'gclid', inferedValue: () => null, defaultValue: null },
  { name: 'msclkid', inferedValue: () => null, defaultValue: null },
  { name: 'network', inferedValue: () => null, defaultValue: null },
  { name: 'keyword', inferedValue: () => null, defaultValue: null },
  { name: 'matchtype', inferedValue: () => null, defaultValue: null },
  { name: 'device', inferedValue: () => null, defaultValue: null },
  { name: 'devicemodel', inferedValue: () => null, defaultValue: null },
  { name: 'adposition', inferedValue: () => null, defaultValue: null },
  { name: 'adgroup', inferedValue: () => null, defaultValue: null },
  { name: 'location', inferedValue: () => null, defaultValue: null },
  { name: 'creative', inferedValue: () => null, defaultValue: null },
  { name: 'sitelink', inferedValue: () => null, defaultValue: null }
];

/**
 * Get URL parameters
 * @param {string} url - The URL to be parsed
 * @param {Object} [location={}] - The location
 * @return {Object}
 */
export function getUrlParameters(url, location = {}) {
  const parsedUrl = new URL(url);
  const params = {};

  UrlParameters.forEach((urlParameter) => {
    let param = parsedUrl.searchParams.get(`upl_${urlParameter.name}`);

    // If the upl_param does not exist, check for the corresponding utm_param
    if (param === null) {
      param = parsedUrl.searchParams.get(`utm_${urlParameter.name}`);
    }

    // Use Google Analytics to try to find something
    if (param === null) {
      param = urlParameter.inferedValue(url, location);
    }

    // Set the touch as direct -- use default values
    if (param === null) {
      param = urlParameter.defaultValue;
    }

    params[urlParameter.name] = param;
  });

  return params;
}

/**
 * Get the source, inferring it from the document.referrer
 * @return {string} the source infered from the referrer
 */
export function getInferedSource() {
  if (!hasReferrer() || isUniplacesReferrer()) {
    return null;
  }

  return getReferrer().host.split('.')[1];
}

/**
 * Get the medium, inferring it from the document.referrer
 * @return {string} the medium infered from the referrer
 */
export function getInferedMedium() {
  if (!hasReferrer() || isUniplacesReferrer()) {
    return null;
  }

  return 'organic';
}
</code></pre>
        </article>
    </section>




</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Wed Jul 11 2018 17:16:02 GMT+0100 (WEST) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
